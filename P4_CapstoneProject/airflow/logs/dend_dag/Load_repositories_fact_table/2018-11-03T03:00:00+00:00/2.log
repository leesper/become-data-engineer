[2019-11-17 15:37:39,371] {taskinstance.py:620} INFO - Dependencies all met for <TaskInstance: dend_dag.Load_repositories_fact_table 2018-11-03T03:00:00+00:00 [queued]>
[2019-11-17 15:37:39,377] {taskinstance.py:620} INFO - Dependencies all met for <TaskInstance: dend_dag.Load_repositories_fact_table 2018-11-03T03:00:00+00:00 [queued]>
[2019-11-17 15:37:39,377] {taskinstance.py:838} INFO - 
--------------------------------------------------------------------------------
[2019-11-17 15:37:39,377] {taskinstance.py:839} INFO - Starting attempt 2 of 4
[2019-11-17 15:37:39,377] {taskinstance.py:840} INFO - 
--------------------------------------------------------------------------------
[2019-11-17 15:37:39,381] {taskinstance.py:859} INFO - Executing <Task(LoadFactOperator): Load_repositories_fact_table> on 2018-11-03T03:00:00+00:00
[2019-11-17 15:37:39,381] {base_task_runner.py:133} INFO - Running: ['airflow', 'run', 'dend_dag', 'Load_repositories_fact_table', '2018-11-03T03:00:00+00:00', '--job_id', '257', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/dend_dag.py', '--cfg_path', '/var/folders/8q/nyxhvd6d55nfqjdbrybk6jpw0000gn/T/tmp2c0aoih6']
[2019-11-17 15:37:40,128] {base_task_runner.py:115} INFO - Job 257: Subtask Load_repositories_fact_table /Users/likejun/anaconda3/lib/python3.7/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use "pip install psycopg2-binary" instead. For details see: <http://initd.org/psycopg/docs/install.html#binary-install-from-pypi>.
[2019-11-17 15:37:40,128] {base_task_runner.py:115} INFO - Job 257: Subtask Load_repositories_fact_table   """)
[2019-11-17 15:37:40,201] {base_task_runner.py:115} INFO - Job 257: Subtask Load_repositories_fact_table [2019-11-17 15:37:40,200] {__init__.py:51} INFO - Using executor SequentialExecutor
[2019-11-17 15:37:40,472] {base_task_runner.py:115} INFO - Job 257: Subtask Load_repositories_fact_table [2019-11-17 15:37:40,471] {dagbag.py:90} INFO - Filling up the DagBag from /Users/likejun/airflow/dags/dend_dag.py
[2019-11-17 15:37:40,485] {base_task_runner.py:115} INFO - Job 257: Subtask Load_repositories_fact_table [2019-11-17 15:37:40,485] {cli.py:516} INFO - Running <TaskInstance: dend_dag.Load_repositories_fact_table 2018-11-03T03:00:00+00:00 [running]> on host likejundeMacBook-Pro.local
[2019-11-17 15:37:40,491] {load_facts.py:21} INFO - LoadFactOperator for repository_fact
[2019-11-17 15:37:40,496] {logging_mixin.py:95} INFO - [[34m2019-11-17 15:37:40,496[0m] {[34mbase_hook.py:[0m84} INFO[0m - Using connection to: [1mid: redshift. Host: redshift-cluster.chjcdyihped1.us-west-2.redshift.amazonaws.com, Port: 5439, Schema: dev, Login: awsuser, Password: XXXXXXXX, extra: {}[0m[0m
[2019-11-17 15:37:42,469] {logging_mixin.py:95} INFO - [[34m2019-11-17 15:37:42,468[0m] {[34mdbapi_hook.py:[0m171} INFO[0m - 
    INSERT INTO repository_fact
        (SELECT
            sp."repository id" AS repository_id,
            sp."repository stars count" AS stars,
            sp."repository forks count" AS forks,
            sp."repository watchers count" AS watchers,
            sp."repository contributors count" AS contributors,
            sp."repository size" AS size,
            sp."repository name with owner" AS repo,
            sv.id AS version_id,
            sv.project_id,
            sp."repository created timestamp" AS create_time,
            sd.id AS dependency_id
            FROM staging_projects sp
            JOIN staging_versions sv
            ON sp.id = sv.project_id
            JOIN staging_dependencies sd
            ON sp.id = sd."project id"
            WHERE sp."repository id" IS NOT NULL 
            AND sp."repository created timestamp" IS NOT NULL)
    [0m
[2019-11-17 16:52:46,996] {taskinstance.py:1051} ERROR - SSL SYSCALL error: EOF detected
Traceback (most recent call last):
  File "/Users/likejun/anaconda3/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 926, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/Users/likejun/airflow/plugins/operators/load_facts.py", line 30, in execute
    pg_hook.run(SqlQueries.repository_table_select)
  File "/Users/likejun/anaconda3/lib/python3.7/site-packages/airflow/hooks/dbapi_hook.py", line 172, in run
    cur.execute(s)
psycopg2.OperationalError: SSL SYSCALL error: EOF detected

[2019-11-17 16:52:46,997] {taskinstance.py:1074} INFO - Marking task as UP_FOR_RETRY
