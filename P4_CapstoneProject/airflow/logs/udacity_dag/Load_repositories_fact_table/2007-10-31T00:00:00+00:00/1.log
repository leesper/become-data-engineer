[2019-11-17 22:30:08,651] {taskinstance.py:620} INFO - Dependencies all met for <TaskInstance: udacity_dag.Load_repositories_fact_table 2007-10-31T00:00:00+00:00 [queued]>
[2019-11-17 22:30:08,656] {taskinstance.py:620} INFO - Dependencies all met for <TaskInstance: udacity_dag.Load_repositories_fact_table 2007-10-31T00:00:00+00:00 [queued]>
[2019-11-17 22:30:08,656] {taskinstance.py:838} INFO - 
--------------------------------------------------------------------------------
[2019-11-17 22:30:08,656] {taskinstance.py:839} INFO - Starting attempt 1 of 4
[2019-11-17 22:30:08,656] {taskinstance.py:840} INFO - 
--------------------------------------------------------------------------------
[2019-11-17 22:30:08,660] {taskinstance.py:859} INFO - Executing <Task(LoadFactOperator): Load_repositories_fact_table> on 2007-10-31T00:00:00+00:00
[2019-11-17 22:30:08,660] {base_task_runner.py:133} INFO - Running: ['airflow', 'run', 'udacity_dag', 'Load_repositories_fact_table', '2007-10-31T00:00:00+00:00', '--job_id', '310', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/udacity_dag.py', '--cfg_path', '/var/folders/8q/nyxhvd6d55nfqjdbrybk6jpw0000gn/T/tmp_87tzlmk']
[2019-11-17 22:30:09,344] {base_task_runner.py:115} INFO - Job 310: Subtask Load_repositories_fact_table /Users/likejun/anaconda3/lib/python3.7/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use "pip install psycopg2-binary" instead. For details see: <http://initd.org/psycopg/docs/install.html#binary-install-from-pypi>.
[2019-11-17 22:30:09,344] {base_task_runner.py:115} INFO - Job 310: Subtask Load_repositories_fact_table   """)
[2019-11-17 22:30:09,418] {base_task_runner.py:115} INFO - Job 310: Subtask Load_repositories_fact_table [2019-11-17 22:30:09,418] {__init__.py:51} INFO - Using executor SequentialExecutor
[2019-11-17 22:30:09,712] {base_task_runner.py:115} INFO - Job 310: Subtask Load_repositories_fact_table [2019-11-17 22:30:09,711] {dagbag.py:90} INFO - Filling up the DagBag from /Users/likejun/airflow/dags/udacity_dag.py
[2019-11-17 22:30:09,727] {base_task_runner.py:115} INFO - Job 310: Subtask Load_repositories_fact_table [2019-11-17 22:30:09,727] {cli.py:516} INFO - Running <TaskInstance: udacity_dag.Load_repositories_fact_table 2007-10-31T00:00:00+00:00 [running]> on host likejundeMacBook-Pro.local
[2019-11-17 22:30:09,734] {load_facts.py:21} INFO - LoadFactOperator for repository_fact
[2019-11-17 22:30:09,740] {logging_mixin.py:95} INFO - [[34m2019-11-17 22:30:09,740[0m] {[34mbase_hook.py:[0m84} INFO[0m - Using connection to: [1mid: redshift. Host: redshift-cluster.chjcdyihped1.us-west-2.redshift.amazonaws.com, Port: 5439, Schema: dev, Login: awsuser, Password: XXXXXXXX, extra: {}[0m[0m
[2019-11-17 22:30:13,663] {logging_mixin.py:95} INFO - [[34m2019-11-17 22:30:13,663[0m] {[34mdbapi_hook.py:[0m171} INFO[0m - 
    INSERT INTO repository_fact
        (SELECT
            sp."repository id" AS repository_id,
            sp."repository stars count" AS stars,
            sp."repository forks count" AS forks,
            sp."repository watchers count" AS watchers,
            sp."repository contributors count" AS contributors,
            sp."repository size" AS size,
            sp."repository name with owner" AS repo,
            sv.id AS version_id,
            sv.project_id,
            sp."repository created timestamp" AS create_time,
            sd.id AS dependency_id
            FROM staging_projects sp
            JOIN staging_versions sv
            ON sp.id = sv.project_id
            JOIN staging_dependencies sd
            ON sp.id = sd."project id"
            WHERE sp."repository id" IS NOT NULL 
            AND TO_CHAR(sp."repository created timestamp", 'YYYY-MM-DD') = '2007-10-31')
    [0m
[2019-11-17 22:30:16,621] {load_facts.py:32} INFO - inserted into repository_fact
[2019-11-17 22:30:18,661] {logging_mixin.py:95} INFO - [[34m2019-11-17 22:30:18,661[0m] {[34mlocal_task_job.py:[0m105} INFO[0m - Task exited with return code 0[0m
